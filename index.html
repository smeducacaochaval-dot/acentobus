<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>AcentoBus</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;background:#1976d2;color:white;text-align:center}
.card{background:white;color:black;margin:30px auto;padding:20px;border-radius:15px;width:330px}
input,button{width:100%;padding:8px;margin-top:8px}
button{background:#1976d2;color:white;border:none;border-radius:8px}
.hidden{display:none}
small{color:#555}
</style>
</head>
<body>

<div class="card" id="loginUser">
  <h2>AcentoBus</h2>
  <input id="nome" placeholder="Seu nome">
  <input id="codigo" placeholder="Seu código">
  <button onclick="entrarUsuario()">Entrar</button>
  <br><br>
  <button onclick="mostrarAdmin()">Sou Administrador</button>
</div>

<div class="card hidden" id="loginAdmin">
  <h3>Login do Administrador</h3>
  <input id="adminUser" placeholder="Usuário">
  <input id="adminPass" type="password" placeholder="Senha">
  <button onclick="entrarAdmin()">Entrar</button>
  <button onclick="voltar()">Voltar</button>
</div>

<div class="card hidden" id="painelAdmin">
  <h3>Painel do Administrador</h3>

  <h4>Configurar ônibus</h4>
  <div id="configOnibus"></div>
  <button onclick="salvarOnibus()">Salvar ônibus</button>

  <hr>

  <h4>Códigos dos usuários</h4>
  <input id="novoCodigo" placeholder="Novo código">
  <button onclick="adicionarCodigo()">Adicionar código</button>
  <div id="listaCodigos"></div>

  <hr>

  <h4>Alterar senha</h4>
  <input id="novaSenha" type="password" placeholder="Nova senha">
  <button onclick="trocarSenha()">Salvar nova senha</button>

  <br><br>
  <button onclick="sair()">Sair</button>
</div>

<div class="card hidden" id="painelUser">
  <h3>Escolha seu ônibus</h3>
  <div id="listaOnibus"></div>
  <button onclick="sair()">Sair</button>
</div>

<script>
const ADMIN_USER="smechaval";
let ADMIN_PASS=localStorage.getItem("adminPass")||"smech@v@l";

let onibus=JSON.parse(localStorage.getItem("onibus"))||[
 {nome:"Ônibus 1",vagas:40},
 {nome:"Ônibus 2",vagas:40},
 {nome:"Ônibus 3",vagas:40},
 {nome:"Ônibus 4",vagas:40},
 {nome:"Ônibus 5",vagas:40}
];

let codigos=JSON.parse(localStorage.getItem("codigos"))||[];

function mostrarAdmin(){
 loginUser.classList.add("hidden");
 loginAdmin.classList.remove("hidden");
}

function voltar(){
 loginAdmin.classList.add("hidden");
 loginUser.classList.remove("hidden");
}

function entrarAdmin(){
 if(adminUser.value===ADMIN_USER && adminPass.value===ADMIN_PASS){
  loginAdmin.classList.add("hidden");
  painelAdmin.classList.remove("hidden");
  carregarConfig();
  listarCodigos();
 } else alert("Usuário ou senha incorretos");
}

function trocarSenha(){
 if(!novaSenha.value){alert("Digite a nova senha");return;}
 ADMIN_PASS=novaSenha.value;
 localStorage.setItem("adminPass",ADMIN_PASS);
 alert("Senha alterada!");
 novaSenha.value="";
}

function carregarConfig(){
 let html="";
 onibus.forEach((o,i)=>{
  html+=`
   <small>Ônibus ${i+1}</small>
   <input value="${o.nome}" onchange="onibus[${i}].nome=this.value">
   <input type="number" value="${o.vagas}" onchange="onibus[${i}].vagas=this.value">
   <br>`;
 });
 configOnibus.innerHTML=html;
}

function salvarOnibus(){
 localStorage.setItem("onibus",JSON.stringify(onibus));
 alert("Ônibus salvos!");
}

function adicionarCodigo(){
 const c=novoCodigo.value.trim();
 if(!c){alert("Digite um código");return;}
 if(codigos.includes(c)){alert("Código já existe");return;}
 codigos.push(c);
 localStorage.setItem("codigos",JSON.stringify(codigos));
 novoCodigo.value="";
 listarCodigos();
}

function listarCodigos(){
 let html="";
 codigos.forEach((c,i)=>{
  html+=`${c} <button onclick="removerCodigo(${i})">❌</button><br>`;
 });
 listaCodigos.innerHTML=html;
}

function removerCodigo(i){
 codigos.splice(i,1);
 localStorage.setItem("codigos",JSON.stringify(codigos));
 listarCodigos();
}

function entrarUsuario(){
 if(!nome.value||!codigo.value){alert("Preencha os campos");return;}
 if(!codigos.includes(codigo.value)){
  alert("Código inválido");
  return;
 }
 loginUser.classList.add("hidden");
 painelUser.classList.remove("hidden");
 listarOnibus();
}

function listarOnibus(){
 let html="";
 onibus.forEach(o=>{
  html+=`<button onclick="alert('Reservado em ${o.nome}')">${o.nome} (${o.vagas} vagas)</button><br>`;
 });
 listaOnibus.innerHTML=html;
}

function sair(){location.reload();}
</script>

</body>
</html>


